!function(e){"use strict";var t=!1;if("undefined"!=typeof module&&module.exports){t=!0;var n=require("request")}var r=!1,i=!1;try{var s=new XMLHttpRequest;"undefined"!=typeof s.withCredentials?r=!0:"XDomainRequest"in window&&(r=!0,i=!0)}catch(a){}var o=Array.prototype.indexOf,l=function(e,t){var n=0,r=e.length;if(o&&e.indexOf===o)return e.indexOf(t);for(;r>n;n++)if(e[n]===t)return n;return-1},c=function(e){return this&&this instanceof c?("string"==typeof e&&(e={key:e}),this.callback=e.callback,this.wanted=e.wanted||[],this.key=e.key,this.simpleSheet=!!e.simpleSheet,this.parseNumbers=!!e.parseNumbers,this.wait=!!e.wait,this.reverse=!!e.reverse,this.postProcess=e.postProcess,this.debug=!!e.debug,this.query=e.query||"",this.orderby=e.orderby,this.endpoint=e.endpoint||"https://spreadsheets.google.com",this.singleton=!!e.singleton,this.simple_url=!!e.simple_url,this.callbackContext=e.callbackContext,"undefined"!=typeof e.proxy&&(this.endpoint=e.proxy.replace(/\/$/,""),this.simple_url=!0,this.singleton=!0,r=!1),this.parameterize=e.parameterize||!1,this.singleton&&("undefined"!=typeof c.singleton&&this.log("WARNING! Tabletop singleton already defined"),c.singleton=this),/key=/.test(this.key)&&(this.log("You passed an old Google Docs url as the key! Attempting to parse."),this.key=this.key.match("key=(.*?)&")[1]),/pubhtml/.test(this.key)&&(this.log("You passed a new Google Spreadsheets url as the key! Attempting to parse."),this.key=this.key.match("d\\/(.*?)\\/pubhtml")[1]),this.key?(this.log("Initializing with key "+this.key),this.models={},this.model_names=[],this.base_json_path="/feeds/worksheets/"+this.key+"/public/basic?alt=",this.base_json_path+=t||r?"json":"json-in-script",void(this.wait||this.fetch())):void this.log("You need to pass Tabletop a key!")):new c(e)};c.callbacks={},c.init=function(e){return new c(e)},c.sheets=function(){this.log("Times have changed! You'll want to use var tabletop = Tabletop.init(...); tabletop.sheets(...); instead of Tabletop.sheets(...)")},c.prototype={fetch:function(e){"undefined"!=typeof e&&(this.callback=e),this.requestData(this.base_json_path,this.loadSheets)},requestData:function(e,n){if(t)this.serverSideFetch(e,n);else{var s=this.endpoint.split("//").shift()||"http";!r||i&&s!==location.protocol?this.injectScript(e,n):this.xhrFetch(e,n)}},xhrFetch:function(e,t){var n=i?new XDomainRequest:new XMLHttpRequest;n.open("GET",this.endpoint+e);var r=this;n.onload=function(){try{var e=JSON.parse(n.responseText)}catch(i){console.error(i)}t.call(r,e)},n.send()},injectScript:function(e,t){var n,r=document.createElement("script");if(this.singleton)t===this.loadSheets?n="Tabletop.singleton.loadSheets":t===this.loadSheet&&(n="Tabletop.singleton.loadSheet");else{var i=this;n="tt"+ +new Date+Math.floor(1e5*Math.random()),c.callbacks[n]=function(){var e=Array.prototype.slice.call(arguments,0);t.apply(i,e),r.parentNode.removeChild(r),delete c.callbacks[n]},n="Tabletop.callbacks."+n}var s=e+"&callback="+n;r.src=this.simple_url?-1!==e.indexOf("/list/")?this.endpoint+"/"+this.key+"-"+e.split("/")[4]:this.endpoint+"/"+this.key:this.endpoint+s,this.parameterize&&(r.src=this.parameterize+encodeURIComponent(r.src)),document.getElementsByTagName("script")[0].parentNode.appendChild(r)},serverSideFetch:function(e,t){var r=this;n({url:this.endpoint+e,json:!0},function(e,n,i){return e?console.error(e):void t.call(r,i)})},isWanted:function(e){return 0===this.wanted.length?!0:-1!==l(this.wanted,e)},data:function(){return 0===this.model_names.length?void 0:this.simpleSheet?(this.model_names.length>1&&this.debug&&this.log("WARNING You have more than one sheet but are using simple sheet mode! Don't blame me when something goes wrong."),this.models[this.model_names[0]].all()):this.models},addWanted:function(e){-1===l(this.wanted,e)&&this.wanted.push(e)},loadSheets:function(e){var n,i,s=[];for(this.foundSheetNames=[],n=0,i=e.feed.entry.length;i>n;n++)if(this.foundSheetNames.push(e.feed.entry[n].title.$t),this.isWanted(e.feed.entry[n].content.$t)){var a=e.feed.entry[n].link.length-1,o=e.feed.entry[n].link[a].href.split("/").pop(),l="/feeds/list/"+this.key+"/"+o+"/public/values?alt=";l+=t||r?"json":"json-in-script",this.query&&(l+="&sq="+this.query),this.orderby&&(l+="&orderby=column:"+this.orderby.toLowerCase()),this.reverse&&(l+="&reverse=true"),s.push(l)}for(this.sheetsToLoad=s.length,n=0,i=s.length;i>n;n++)this.requestData(s[n],this.loadSheet)},sheets:function(e){return"undefined"==typeof e?this.models:"undefined"==typeof this.models[e]?void 0:this.models[e]},loadSheet:function(e){var t=new c.Model({data:e,parseNumbers:this.parseNumbers,postProcess:this.postProcess,tabletop:this});this.models[t.name]=t,-1===l(this.model_names,t.name)&&this.model_names.push(t.name),this.sheetsToLoad--,0===this.sheetsToLoad&&this.doCallback()},doCallback:function(){0===this.sheetsToLoad&&this.callback.apply(this.callbackContext||this,[this.data(),this])},log:function(){this.debug&&"undefined"!=typeof console&&"undefined"!=typeof console.log&&Function.prototype.apply.apply(console.log,[console,arguments])}},c.Model=function(e){var t,n,r,i;if(this.column_names=[],this.name=e.data.feed.title.$t,this.elements=[],this.raw=e.data,"undefined"==typeof e.data.feed.entry)return e.tabletop.log("Missing data for "+this.name+", make sure you didn't forget column headers"),void(this.elements=[]);for(var s in e.data.feed.entry[0])/^gsx/.test(s)&&this.column_names.push(s.replace("gsx$",""));for(t=0,r=e.data.feed.entry.length;r>t;t++){for(var a=e.data.feed.entry[t],o={},n=0,i=this.column_names.length;i>n;n++){var l=a["gsx$"+this.column_names[n]];o[this.column_names[n]]="undefined"!=typeof l?e.parseNumbers&&""!==l.$t&&!isNaN(l.$t)?+l.$t:l.$t:""}void 0===o.rowNumber&&(o.rowNumber=t+1),e.postProcess&&e.postProcess(o),this.elements.push(o)}},c.Model.prototype={all:function(){return this.elements},toArray:function(){var e,t,n,r,i=[];for(e=0,n=this.elements.length;n>e;e++){var s=[];for(t=0,r=this.column_names.length;r>t;t++)s.push(this.elements[e][this.column_names[t]]);i.push(s)}return i}},t?module.exports=c:e.Tabletop=c}(this),function(){var e,t,n,r;!function(){var i={},s={};e=function(e,t,n){i[e]={deps:t,callback:n}},r=n=t=function(e){function n(t){if("."!==t.charAt(0))return t;for(var n=t.split("/"),r=e.split("/").slice(0,-1),i=0,s=n.length;s>i;i++){var a=n[i];if(".."===a)r.pop();else{if("."===a)continue;r.push(a)}}return r.join("/")}if(r._eak_seen=i,s[e])return s[e];if(s[e]={},!i[e])throw new Error("Could not find module "+e);for(var a,o=i[e],l=o.deps,c=o.callback,u=[],h=0,f=l.length;f>h;h++)u.push("exports"===l[h]?a={}:t(n(l[h])));var p=c.apply(this,u);return s[e]=a||p}}(),e("promise/all",["./utils","exports"],function(e,t){"use strict";function n(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to all.");return new t(function(t,n){function r(e){return function(t){s(e,t)}}function s(e,n){o[e]=n,0===--l&&t(o)}var a,o=[],l=e.length;0===l&&t([]);for(var c=0;c<e.length;c++)a=e[c],a&&i(a.then)?a.then(r(c),n):s(c,a)})}var r=e.isArray,i=e.isFunction;t.all=n}),e("promise/asap",["exports"],function(e){"use strict";function t(){return function(){process.nextTick(i)}}function n(){var e=0,t=new l(i),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function r(){return function(){c.setTimeout(i,1)}}function i(){for(var e=0;e<u.length;e++){var t=u[e],n=t[0],r=t[1];n(r)}u=[]}function s(e,t){var n=u.push([e,t]);1===n&&a()}var a,o="undefined"!=typeof window?window:{},l=o.MutationObserver||o.WebKitMutationObserver,c="undefined"!=typeof global?global:void 0===this?window:this,u=[];a="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?t():l?n():r(),e.asap=s}),e("promise/config",["exports"],function(e){"use strict";function t(e,t){return 2!==arguments.length?n[e]:void(n[e]=t)}var n={instrument:!1};e.config=n,e.configure=t}),e("promise/polyfill",["./promise","./utils","exports"],function(e,t,n){"use strict";function r(){var e;e="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var t="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),s(t)}();t||(e.Promise=i)}var i=e.Promise,s=t.isFunction;n.polyfill=r}),e("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(e,t,n,r,i,s,a,o){"use strict";function l(e){if(!k(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof l))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],c(e,this)}function c(e,t){function n(e){d(t,e)}function r(e){v(t,e)}try{e(n,r)}catch(i){r(i)}}function u(e,t,n,r){var i,s,a,o,l=k(n);if(l)try{i=n(r),a=!0}catch(c){o=!0,s=c}else i=r,a=!0;p(t,i)||(l&&a?d(t,i):o?v(t,s):e===j?d(t,i):e===L&&v(t,i))}function h(e,t,n,r){var i=e._subscribers,s=i.length;i[s]=t,i[s+j]=n,i[s+L]=r}function f(e,t){for(var n,r,i=e._subscribers,s=e._detail,a=0;a<i.length;a+=3)n=i[a],r=i[a+t],u(t,n,r,s);e._subscribers=null}function p(e,t){var n,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(_(t)&&(r=t.then,k(r)))return r.call(t,function(r){return n?!0:(n=!0,void(t!==r?d(e,r):g(e,r)))},function(t){return n?!0:(n=!0,void v(e,t))}),!0}catch(i){return n?!0:(v(e,i),!0)}return!1}function d(e,t){e===t?g(e,t):p(e,t)||g(e,t)}function g(e,t){e._state===M&&(e._state=N,e._detail=t,y.async(m,e))}function v(e,t){e._state===M&&(e._state=N,e._detail=t,y.async(b,e))}function m(e){f(e,e._state=j)}function b(e){f(e,e._state=L)}var y=e.config,_=(e.configure,t.objectOrFunction),k=t.isFunction,w=(t.now,n.all),x=r.race,T=i.resolve,C=s.reject,S=a.asap;y.async=S;var M=void 0,N=0,j=1,L=2;l.prototype={constructor:l,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var n=this,r=new this.constructor(function(){});if(this._state){var i=arguments;y.async(function(){u(n._state,r,i[n._state-1],n._detail)})}else h(this,r,e,t);return r},"catch":function(e){return this.then(null,e)}},l.all=w,l.race=x,l.resolve=T,l.reject=C,o.Promise=l}),e("promise/race",["./utils","exports"],function(e,t){"use strict";function n(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to race.");return new t(function(t,n){for(var r,i=0;i<e.length;i++)r=e[i],r&&"function"==typeof r.then?r.then(t,n):t(r)})}var r=e.isArray;t.race=n}),e("promise/reject",["exports"],function(e){"use strict";function t(e){var t=this;return new t(function(t,n){n(e)})}e.reject=t}),e("promise/resolve",["exports"],function(e){"use strict";function t(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}e.resolve=t}),e("promise/utils",["exports"],function(e){"use strict";function t(e){return n(e)||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}var i=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=t,e.isFunction=n,e.isArray=r,e.now=i}),t("promise/polyfill").polyfill()}(),function(e){function t(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function n(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function r(e){for(var t=0,n=-1;-1!==(n=e.indexOf("\n",n+1));)t++;return t}function i(e,t){function n(e){this.len_after=e,this.name="close_"+t}var r=e+"_state",i="strong"==e?"em_state":"strong_state";return function(s){if(this[r][0]==t)return this[r].shift(),[s.length,new n(s.length-t.length)];var a=this[i].slice(),o=this[r].slice();this[r].unshift(t);{var l=this.processInline(s.substr(t.length)),c=l[l.length-1];this[r].shift()}if(c instanceof n){l.pop();var u=s.length-c.len_after;return[u,[e].concat(l)]}return this[i]=a,this[r]=o,[t.length,t]}}function s(e){for(var t=e.split(""),n=[""],r=!1;t.length;){var i=t.shift();switch(i){case" ":r?n[n.length-1]+=i:n.push("");break;case"'":case'"':r=!r;break;case"\\":i=t.shift();default:n[n.length-1]+=i}}return n}function o(e){return v(e)&&e.length>1&&"object"==typeof e[1]&&!v(e[1])?e[1]:void 0}function l(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e){if("string"==typeof e)return l(e);var t=e.shift(),n={},r=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)r.push(c(e.shift()));var i="";for(var s in n)i+=" "+s+'="'+l(n[s])+'"';return"img"==t||"br"==t||"hr"==t?"<"+t+i+"/>":"<"+t+i+">"+r.join("")+"</"+t+">"}function u(e,t,n){var r;n=n||{};var i=e.slice(0);"function"==typeof n.preprocessTreeNode&&(i=n.preprocessTreeNode(i,t));var s=o(i);if(s){i[1]={};for(r in s)i[1][r]=s[r];s=i[1]}if("string"==typeof i)return i;switch(i[0]){case"header":i[0]="h"+i[1].level,delete i[1].level;break;case"bulletlist":i[0]="ul";break;case"numberlist":i[0]="ol";break;case"listitem":i[0]="li";break;case"para":i[0]="p";break;case"markdown":i[0]="html",s&&delete s.references;break;case"code_block":i[0]="pre",r=s?2:1;var a=["code"];a.push.apply(a,i.splice(r,i.length-r)),i[r]=a;break;case"inlinecode":i[0]="code";break;case"img":i[1].src=i[1].href,delete i[1].href;break;case"linebreak":i[0]="br";break;case"link":i[0]="a";break;case"link_ref":i[0]="a";var l=t[s.ref];if(!l)return s.original;delete s.ref,s.href=l.href,l.title&&(s.title=l.title),delete s.original;break;case"img_ref":i[0]="img";var l=t[s.ref];if(!l)return s.original;delete s.ref,s.src=l.href,l.title&&(s.title=l.title),delete s.original}if(r=1,s){for(var c in i[1]){r=2;break}1===r&&i.splice(r,1)}for(;r<i.length;++r)i[r]=u(i[r],t,n);return i}function h(e){for(var t=o(e)?2:1;t<e.length;)"string"==typeof e[t]?t+1<e.length&&"string"==typeof e[t+1]?e[t]+=e.splice(t+1,1)[0]:++t:(h(e[t]),++t)}var f=e.Markdown=function(e){switch(typeof e){case"undefined":this.dialect=f.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in f.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=f.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};e.parse=function(e,t){var n=new f(t);return n.toTree(e)},e.toHTML=function(t,n,r){var i=e.toHTMLTree(t,n,r);return e.renderJsonML(i)},e.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var r=o(e),i={};r&&r.references&&(i=r.references);var s=u(e,i,n);return h(s),s};var d=f.mk_block=function(e,r,i){1==arguments.length&&(r="\n\n");var s=new String(e);return s.trailing=r,s.inspect=n,s.toSource=t,void 0!=i&&(s.lineNumber=i),s};f.prototype.split_blocks=function(e){e=e.replace(/(\r\n|\n|\r)/g,"\n");var t,n=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,i=[],s=1;for(null!=(t=/^(\s*\n)/.exec(e))&&(s+=r(t[0]),n.lastIndex=t[0].length);null!==(t=n.exec(e));)"\n#"==t[2]&&(t[2]="\n",n.lastIndex--),i.push(d(t[1],t[2],s)),s+=r(t[0]);return i},f.prototype.processBlock=function(e,t){var n=this.dialect.block,r=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var i=0;i<r.length;i++){var s=n[r[i]].call(this,e,t);if(s)return(!v(s)||s.length>0&&!v(s[0]))&&this.debug(r[i],"didn't return a proper array"),s}return[]},f.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},f.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),r=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var i=this.processBlock(n.shift(),n);i.length&&this.tree.push.apply(this.tree,i)}return this.tree}finally{t&&(this.tree=r)}},f.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,e)},f.prototype.loop_re_over_block=function(e,t,n){for(var r,i=t.valueOf();i.length&&null!=(r=e.exec(i));)i=i.substr(r[0].length),n.call(this,r);return i},f.dialects={},f.dialects.Gruber={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!n)return void 0;var r=["header",{level:n[1].length}];return Array.prototype.push.apply(r,this.processInline(n[2])),n[0].length<e.length&&t.unshift(d(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!n)return void 0;var r="="===n[2]?1:2,i=["header",{level:r},n[1]];return n[0].length<e.length&&t.unshift(d(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[i]},code:function(e,t){var n=[],r=/^(?: {0,3}\t| {4})(.*)\n?/;if(!e.match(r))return void 0;e:for(;;){var i=this.loop_re_over_block(r,e.valueOf(),function(e){n.push(e[1])});if(i.length){t.unshift(d(i,e.trailing));break e}if(!t.length)break e;if(!t[0].match(r))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!n)return void 0;var r=[["hr"]];return n[1]&&r.unshift.apply(r,this.processBlock(n[1],[])),n[3]&&t.unshift(d(n[3])),r},lists:function(){function e(e){return new RegExp("(?:^("+l+"{0,"+e+"} {0,3})("+s+")\\s+)|(^"+l+"{0,"+(e-1)+"}[ ]{0,4})")}function t(e){return e.replace(/ {0,3}\t/g,"    ")}function n(e,t,n,r){if(t)return void e.push(["para"].concat(n));var i=e[e.length-1]instanceof Array&&"para"==e[e.length-1][0]?e[e.length-1]:e;r&&e.length>1&&n.unshift(r);for(var s=0;s<n.length;s++){var a=n[s],o="string"==typeof a;o&&i.length>1&&"string"==typeof i[i.length-1]?i[i.length-1]+=a:i.push(a)}}function r(e,t){for(var n=new RegExp("^("+l+"{"+e+"}.*?\\n?)*$"),r=new RegExp("^"+l+"{"+e+"}","gm"),i=[];t.length>0&&n.exec(t[0]);){var s=t.shift(),a=s.replace(r,"");i.push(d(a,s.trailing,s.lineNumber))}return i}function i(e,t,n){var r=e.list,i=r[r.length-1];if(!(i[1]instanceof Array&&"para"==i[1][0]))if(t+1==n.length)i.push(["para"].concat(i.splice(1,i.length-1)));else{var s=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),s)}}var s="[*+-]|\\d+\\.",a=/[*+-]/,o=new RegExp("^( {0,3})("+s+")[ 	]+"),l="(?: {0,3}\\t| {4})";return function(s,l){function c(e){var t=a.exec(e[2])?["bulletlist"]:["numberlist"];return p.push({list:t,indent:e[1]}),t}var u=s.match(o);if(!u)return void 0;for(var h,f,p=[],d=c(u),v=!1,m=[p[0].list];;){for(var b=s.split(/(?=\n)/),y="",_=0;_<b.length;_++){var k="",w=b[_].replace(/^\n/,function(e){return k=e,""}),x=e(p.length);if(u=w.match(x),void 0!==u[1]){y.length&&(n(h,v,this.processInline(y),k),v=!1,y=""),u[1]=t(u[1]);var T=Math.floor(u[1].length/4)+1;if(T>p.length)d=c(u),h.push(d),h=d[1]=["listitem"];else{var C=!1;for(f=0;f<p.length;f++)if(p[f].indent==u[1]){d=p[f].list,p.splice(f+1,p.length-(f+1)),C=!0;break}C||(T++,T<=p.length?(p.splice(T,p.length-T),d=p[T-1].list):(d=c(u),h.push(d))),h=["listitem"],d.push(h)}k=""}w.length>u[0].length&&(y+=k+w.substr(u[0].length))}y.length&&(n(h,v,this.processInline(y),k),v=!1,y="");var S=r(p.length,l);S.length>0&&(g(p,i,this),h.push.apply(h,this.toTree(S,[])));var M=l[0]&&l[0].valueOf()||"";if(!M.match(o)&&!M.match(/^ /))break;s=l.shift();var N=this.dialect.block.horizRule(s,l);if(N){m.push.apply(m,N);break}g(p,i,this),v=!0}return m}}(),blockquote:function(e,t){if(!e.match(/^>/m))return void 0;var n=[];if(">"!=e[0]){for(var r=e.split(/\n/),i=[],s=e.lineNumber;r.length&&">"!=r[0][0];)i.push(r.shift()),s++;var a=d(i.join("\n"),"\n",e.lineNumber);n.push.apply(n,this.processBlock(a,[])),e=d(r.join("\n"),e.trailing,s)}for(;t.length&&">"==t[0][0];){var l=t.shift();e=d(e+e.trailing+l,l.trailing,e.lineNumber)}var c=e.replace(/^> ?/gm,""),u=(this.tree,this.toTree(c,["blockquote"])),h=o(u);return h&&h.references&&(delete h.references,m(h)&&u.splice(1,1)),n.push(u),n},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!e.match(n))return void 0;o(this.tree)||this.tree.splice(1,0,{});var r=o(this.tree);void 0===r.references&&(r.references={});var i=this.loop_re_over_block(n,e,function(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=r.references[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])});return i.length&&t.unshift(d(i,e.trailing)),[]},para:function(e){return[["para"].concat(this.processInline(e))]}}},f.dialects.Gruber.inline={__oneElement__:function(e,t,n){var r,i;t=t||this.dialect.inline.__patterns__;var s=new RegExp("([\\s\\S]*?)("+(t.source||t)+")");if(r=s.exec(e),!r)return[e.length,e];if(r[1])return[r[1].length,r[1]];var i;return r[2]in this.dialect.inline&&(i=this.dialect.inline[r[2]].call(this,e.substr(r.index),r,n||[])),i=i||[r[2].length,r[2]]},__call__:function(e,t){function n(e){"string"==typeof e&&"string"==typeof i[i.length-1]?i[i.length-1]+=e:i.push(e)}for(var r,i=[];e.length>0;)r=this.dialect.inline.__oneElement__.call(this,e,t,i),e=e.substr(r.shift()),g(r,n);return i},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(e){return this.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),t?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function b(e){var t=String(e),n=f.DialectHelpers.inline_until_char.call(this,e.substr(1),"]");if(!n)return[1,"["];var b,r,i=1+n[0],s=n[1];e=e.substr(i);var a=e.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(a){var o=a[1];if(i+=a[0].length,o&&"<"==o[0]&&">"==o[o.length-1]&&(o=o.substring(1,o.length-1)),!a[3])for(var l=1,c=0;c<o.length;c++)switch(o[c]){case"(":l++;break;case")":0==--l&&(i-=o.length-c,o=o.substring(0,c))}return o=this.dialect.inline.__call__.call(this,o,/\\/)[0],r={href:o||""},void 0!==a[3]&&(r.title=a[3]),b=["link",r].concat(s),[i,b]}return a=e.match(/^\s*\[(.*?)\]/),a?(i+=a[0].length,r={ref:(a[1]||String(s)).toLowerCase(),original:t.substr(0,i)},b=["link_ref",r].concat(s),[i,b]):1==s.length&&"string"==typeof s[0]?(r={ref:s[0].toLowerCase(),original:t.substr(0,i)},b=["link_ref",r,s[0]],[i,b]):[1,"["]},"<":function(e){var t;return null!=(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"==t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}},f.dialects.Gruber.inline["**"]=i("strong","**"),f.dialects.Gruber.inline.__=i("strong","__"),f.dialects.Gruber.inline["*"]=i("em","*"),f.dialects.Gruber.inline._=i("em","_"),f.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!=n&&"__call__"!=n&&t.push(n);e.__order__=t},f.buildInlinePatterns=function(e){var t=[];for(var n in e)if(!n.match(/^__.*__$/)){var r=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(1==n.length?r:"(?:"+r+")")}t=t.join("|"),e.__patterns__=t;var i=e.__call__;e.__call__=function(e,n){return void 0!=n?i.call(this,e,n):i.call(this,e,t)}},f.DialectHelpers={},f.DialectHelpers.inline_until_char=function(e,t){for(var n=0,r=[];;){if(e.charAt(n)==t)return n++,[n,r];if(n>=e.length)return null;var i=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=i[0],r.push.apply(r,i.slice(1))}},f.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}},f.buildBlockOrder(f.dialects.Gruber.block),f.buildInlinePatterns(f.dialects.Gruber.inline),f.dialects.Maruku=f.subclassDialect(f.dialects.Gruber),f.dialects.Maruku.processMetaHash=function(e){for(var t=s(e),n={},r=0;r<t.length;++r)if(/^#/.test(t[r]))n.id=t[r].substring(1);else if(/^\./.test(t[r]))n["class"]=n["class"]?n["class"]+t[r].replace(/./," "):t[r].substring(1);else if(/\=/.test(t[r])){var i=t[r].split(/\=/);n[i[0]]=i[1]}return n},f.dialects.Maruku.block.document_meta=function(e){if(e.lineNumber>1)return void 0;if(!e.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;o(this.tree)||this.tree.splice(1,0,{});var t=e.split(/\n/);for(p in t){var n=t[p].match(/(\w+):\s*(.*)$/),r=n[1].toLowerCase(),i=n[2];this.tree[1][r]=i}return[]},f.dialects.Maruku.block.block_meta=function(e){var t=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!t)return void 0;var n,r=this.dialect.processMetaHash(t[2]);if(""===t[1]){var i=this.tree[this.tree.length-1];if(n=o(i),"string"==typeof i)return void 0;n||(n={},i.splice(1,0,n));for(a in r)n[a]=r[a];return[]}var s=e.replace(/\n.*$/,""),l=this.processBlock(s,[]);n=o(l[0]),n||(n={},l[0].splice(1,0,n));for(a in r)n[a]=r[a];return l},f.dialects.Maruku.block.definition_list=function(e,t){var n,r,i=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,s=["dl"];if(!(r=e.match(i)))return void 0;for(var a=[e];t.length&&i.exec(t[0]);)a.push(t.shift());for(var o=0;o<a.length;++o){var r=a[o].match(i),l=r[1].replace(/\n$/,"").split(/\n/),c=r[2].split(/\n:\s+/);for(n=0;n<l.length;++n)s.push(["dt",l[n]]);for(n=0;n<c.length;++n)s.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[s]},f.dialects.Maruku.block.table=function y(e){var t,n,r=function(e,t){t=t||"\\s",t.match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var n,r=[],i=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)");n=e.match(i);)r.push(n[1]),e=n[2];return r.push(e),r},i=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,s=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(n=e.match(i))n[3]=n[3].replace(/^\s*\|/gm,"");else if(!(n=e.match(s)))return void 0;var y=["table",["thead",["tr"]],["tbody"]];n[2]=n[2].replace(/\|\s*$/,"").split("|");var a=[];for(g(n[2],function(e){a.push(e.match(/^\s*-+:\s*$/)?{align:"right"}:e.match(/^\s*:-+\s*$/)?{align:"left"}:e.match(/^\s*:-+:\s*$/)?{align:"center"}:{})}),n[1]=r(n[1].replace(/\|\s*$/,""),"|"),t=0;t<n[1].length;t++)y[1][1].push(["th",a[t]||{}].concat(this.processInline(n[1][t].trim())));return g(n[3].replace(/\|\s*$/gm,"").split("\n"),function(e){var n=["tr"];for(e=r(e,"|"),t=0;t<e.length;t++)n.push(["td",a[t]||{}].concat(this.processInline(e[t].trim())));y[2].push(n)},this),[y]},f.dialects.Maruku.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var r=n[n.length-1];if("string"==typeof r)return[2,"{:"];var i=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!i)return[2,"{:"];var s=this.dialect.processMetaHash(i[1]),a=o(r);a||(a={},r.splice(1,0,a));for(var l in s)a[l]=s[l];return[i[0].length,""]},f.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,f.buildBlockOrder(f.dialects.Maruku.block),f.buildInlinePatterns(f.dialects.Maruku.inline);var g,v=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};g=Array.prototype.forEach?function(e,t,n){return e.forEach(t,n)}:function(e,t,n){for(var r=0;r<e.length;r++)t.call(n||e,e[r],r,e)};var m=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0};e.renderJsonML=function(e,t){t=t||{},t.root=t.root||!1;var n=[];if(t.root)n.push(c(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(c(e.shift()));return n.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}());var JsonML=JsonML||{};!function(e,t){"use strict";function n(e){this.value=e}function r(e){return"function"==typeof e}function i(e){switch(typeof e){case"object":return e?b(e)?p:m(e)?v:e instanceof Date?g:d:h;case"function":return f;case"undefined":return h;default:return g}}var s={accesskey:"accessKey",bgcolor:"bgColor",cellpadding:"cellPadding",cellspacing:"cellSpacing",checked:"defaultChecked","class":"className",colspan:"colSpan",contenteditable:"contentEditable",defaultchecked:"defaultChecked","for":"htmlFor",formnovalidate:"formNoValidate",hidefocus:"hideFocus",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",readonly:"readOnly",rowspan:"rowSpan",spellcheck:"spellCheck",tabindex:"tabIndex",usemap:"useMap",willvalidate:"willValidate"},a={enctype:"encoding",onscroll:"DOMMouseScroll"},o={autocapitalize:1,autocomplete:1,autocorrect:1},l={async:1,autofocus:1,checked:1,defaultchecked:1,defer:1,disabled:1,formnovalidate:1,hidden:1,indeterminate:1,ismap:1,multiple:1,novalidate:1,readonly:1,required:1,spellcheck:1,willvalidate:1},c=/^[\r\n]+/,u=/[\r\n]+$/,h=0,f=1,p=2,d=3,g=4,v=5;n.prototype.toString=function(){return this.value},e.raw=function(e){return new n(e)};var m=e.isRaw=function(e){return e instanceof n},b=Array.isArray||function(e){return e instanceof Array},y=function(e){if(e){if("!"===e.charAt(0))return t.createComment("!"===e?"":e.substr(1)+" ")}else{if(t.createDocumentFragment)return t.createDocumentFragment();e=""}return"style"===e.toLowerCase()&&t.createStyleSheet?t.createStyleSheet():t.createElement(e)},_=function(e,t,n){switch("on"===t.substr(0,2)&&(t=t.substr(2)),typeof n){case"function":if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent&&i(e[t])!==h)e.attachEvent("on"+t,n);else{var s=e["on"+t]||e[t];e["on"+t]=e[t]=r(s)?function(e){return s.call(this,e)!==!1&&n.call(this,e)!==!1}:n}break;case"string":e["on"+t]=new Function("event",n)}},k=function(e,n){if(n.name&&t.attachEvent&&!e.parentNode)try{var r=y("<"+e.tagName+' name="'+n.name+'">');e.tagName===r.tagName&&(e=r)}catch(c){}for(var u in n)if(n.hasOwnProperty(u)){var f=n[u],p=i(f);u&&(p===h&&(f="",p=g),u=s[u.toLowerCase()]||u,"style"===u?i(e.style.cssText)!==h?e.style.cssText=f:e.style=f:"on"===u.substr(0,2)?(_(e,u,f),u=a[u],u&&_(e,u,f)):o[u.toLowerCase()]||p===g&&"$"!==u.charAt(0)&&i(e[u])===h&&i(e[a[u]])===h?l[u.toLowerCase()]?f&&(e.setAttribute(u,u),u=a[u],u&&e.setAttribute(u,u)):(e.setAttribute(u,f),u=a[u],u&&e.setAttribute(u,f)):(e[u]=f,u=a[u],u&&(e[u]=f)))}return e},w=function(e,n){if(n){var r=(e.tagName||"").toLowerCase();if(8===e.nodeType)3===n.nodeType&&(e.nodeValue+=n.nodeValue);else if("table"===r&&e.tBodies){if(!n.tagName){if(11===n.nodeType)for(;n.firstChild;)w(e,n.removeChild(n.firstChild));return}var i=n.tagName.toLowerCase();if(i&&"tbody"!==i&&"thead"!==i){var s=e.tBodies.length>0?e.tBodies[e.tBodies.length-1]:null;s||(s=y("th"===i?"thead":"tbody"),e.appendChild(s)),s.appendChild(n)}else e.canHaveChildren!==!1&&e.appendChild(n)}else if("style"===r&&t.createStyleSheet)e.cssText=n;else if(e.canHaveChildren!==!1)e.appendChild(n);else if("object"===r&&n.tagName&&"param"===n.tagName.toLowerCase()){try{e.appendChild(n)}catch(a){}try{e.object&&(e.object[n.name]=n.value)}catch(o){}}}},x=function(e){return!(!e||3!==e.nodeType||e.nodeValue&&/\S/.exec(e.nodeValue))},T=function(e,t){e&&3===e.nodeType&&t.exec(e.nodeValue)&&(e.nodeValue=e.nodeValue.replace(t,""))},C=function(e){if(e){for(;x(e.firstChild);)e.removeChild(e.firstChild);for(T(e.firstChild,c);x(e.lastChild);)e.removeChild(e.lastChild);T(e.lastChild,u)}},S=function(e){var t=y("div");if(t.innerHTML=""+e,C(t),1===t.childNodes.length)return t.firstChild;for(var n=y("");t.firstChild;)n.appendChild(t.firstChild);return n},M=function(e){return t.createTextNode("["+e+"]")};e.onerror=null;var N=e.patch=function(e,t,n){for(var r=1;r<t.length;r++)b(t[r])||"string"==typeof t[r]?w(e,j(t[r],n)):m(t[r])?w(e,S(t[r].value)):"object"==typeof t[r]&&null!==t[r]&&1===e.nodeType&&(e=k(e,t[r]));return e},j=e.toHTML=function(n,i){try{if(!n)return null;if("string"==typeof n)return t.createTextNode(n);
if(m(n))return S(n.value);if(!b(n)||"string"!=typeof n[0])throw new SyntaxError("invalid JsonML");var s=n[0];if(!s){for(var a=y(""),o=1;o<n.length;o++)w(a,j(n[o],i));return C(a),1===a.childNodes.length?a.firstChild:a}if("style"===s.toLowerCase()&&t.createStyleSheet)return N(t.createStyleSheet(),n,i),null;var l=N(y(s),n,i);return C(l),l&&r(i)?i(l):l}catch(c){try{var u=r(e.onerror)?e.onerror:M;return u(c,n,i)}catch(h){return t.createTextNode("["+h+"]")}}};e.toHTMLText=function(e,t){var n=j(e,t);if(n.outerHTML)return n.outerHTML;var r=y("div");r.appendChild(n);var i=r.innerHTML;return r.removeChild(n),i}}(JsonML,document);var afb=afb||{};afb.Table=function(e){function t(e){return new Promise(function(t){Tabletop.init({key:e,callback:function(e){t(e)},simpleSheet:!0})})}function n(e){return e}function r(e,t){var n=document.createElement("table");return t.forEach(function(t){var r=document.createElement("tr");e.forEach(function(e,n){var i,s=t[e];if(0===n){var l=/([0-9]{2})\.([0-9]{2})\.([0-9]{2})@(heldags|[0-9]{2}.[0-9]{2})(?:[–|-])?([0-9]{2}\.[0-9]{2})?/,c=l.exec(s),u=Number(c[3])+2e3,h=new Date(u,c[2]-1,c[1]),f=a[h.getDay()],p=c[1],d=o[c[2]-1],g=f+" "+p+". "+d;c[4].length<6&&(g+=" kl. "+c[4]),void 0!==c[5]&&(g+="–"+c[5]),i=document.createElement("th"),i.appendChild(document.createTextNode(g))}else{i=document.createDocumentFragment();var v=markdown.toHTMLTree(s)[1];v.splice(0,1,"td");var m=JsonML.toHTML(v);i.appendChild(m)}r.appendChild(i)}),n.appendChild(r)}),n}function i(e,t){e.appendChild(t)}function s(e){console.error(e)}window.paras=[];var a=["søn","man","tir","ons","tor","fre","lør","søn"],o=["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"];Object.keys(e).forEach(function(t){this[t]=e[t]}.bind(this)),t.bind(void 0,this.key)().then(n).then(r.bind(void 0,this.columns)).then(i.bind(void 0,this.el)).catch(s)};